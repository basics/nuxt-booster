var _=Object.defineProperty;var C=(e,t,s)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var d=(e,t,s)=>C(e,typeof t!="symbol"?t+"":t,s);import{D as $}from"./CdBoK2La.js";import{D as I,a as k}from"./B6OufE0o.js";import{_ as D}from"./c_qDLON9.js";import{_ as g,r as B,C as N,ae as A,M as c,o as f,c as m,A as a,x as y,b as h,w as n,m as b,k as L,p as E,a as o}from"./clJAH_i8.js";import{u as Y}from"./1v1T_LhC.js";import{u as j}from"./DQma1gOb.js";const w=new I;typeof window<"u"&&(window.onYouTubeIframeAPIReady=()=>{w.resolve(window.YT)});const V=()=>({key:"youtube",src:"https://www.youtube.com/iframe_api",async:!0,defer:!0}),M=()=>w.promise;class R{constructor(){d(this,"api");d(this,"players",new Map)}play(t){return this.pausePlayers(),t.playVideo()}pausePlayers(t){Array.from(this.players.values()).filter(s=>!t||t&&s!==t).filter(s=>s.getPlayerState).forEach(s=>{s.getPlayerState()===this.api.PlayerState.PLAYING&&s.pauseVideo()})}async createPlayer(...t){this.api=await M();const s=new this.api.Player(...t);return s.addEventListener("onStateChange",({data:u})=>{this.api.PlayerState.PLAYING===u&&this.pausePlayers(s)}),this.add(s),s}add(t){this.players.set(t.id,t)}remove(t){this.players.delete(t.id),t.destroy()}}const v={autoplay:{type:Boolean,default:!1},mute:{type:Boolean,default:void 0},url:{type:String,required:!0},title:{type:String,required:!0},host:{type:String,default:"https://www.youtube-nocookie.com"},options:{type:Object,default(){return{}}},posterSources:{type:Array,default(){return[{src:void 0,media:"all",sizes:{default:"100vw"}}]}}},l=new R,T={components:{BoosterPicture:D,DefaultButton:$},props:v,emits:["ready","playing"],setup(){j();const e=B([]);return Y({script:N(()=>e.value)}),{script:e}},data(){return{src:null,videoId:new URL(this.url).searchParams.get("v"),player:null,ready:!1,loading:!1,playing:!1,landscape:!1,isTouchDevice:k()}},computed:{pictureDataset(){return{formats:this.$booster.targetFormats,title:this.title,sources:this.posterSources.map(e=>({...e,src:e.src||`/youtube/vi/${this.videoId}/maxresdefault.jpg`}))}}},mounted(){this.autoplay&&this.onInit()},unmounted(){this.player&&l.remove(this.player)},methods:{reset(){this.src=null,this.ready=!1,this.playing=!1},onInit(){this.loading=!0;const e={rel:0,enablejsapi:1,autoplay:0,modestbranding:1,showinfo:0,iv_load_policy:3,...this.options,playsinline:1,mute:Number(this.isTouchDevice)||Number(this.mute)};this.src=`${this.host}/embed/${this.videoId}?`+Object.entries(e).map(([t,s])=>`${t}=${s}`).join("&"),this.script=[V()]},async onLoad(){this.player=A(await l.createPlayer(this.$refs.player,{videoId:this.videoId,host:this.host,events:{onReady:e=>{e.target.mute(),l.play(e.target),this.loading=!1,this.ready=!0,this.$emit("ready",{iframe:e.target.getIframe(),player:this.player})},onStateChange:e=>this.onPlayerStateChange(l.api,e.data)}}))},onPlayerStateChange(e,t){t===e.PlayerState.PLAYING?this.playing=!0:(t===e.PlayerState.ENDED||t===e.PlayerState.PAUSED)&&(this.playing=!1),this.$emit("playing",this.playing)}}},z=["title","src"];function G(e,t,s,u,r,i){const p=c("booster-picture"),P=c("default-button");return f(),m("div",{class:L({ready:r.ready,playing:r.playing})},[a(e.$slots,"beforePlayer",{},void 0,!0),r.src?(f(),m("iframe",{key:0,ref:"player",title:e.title,class:"player",src:r.src,allow:"accelerometer; fullscreen; clipboard-write; encrypted-media; gyroscope; picture-in-picture",onLoad:t[0]||(t[0]=(...S)=>i.onLoad&&i.onLoad(...S))},null,40,z)):y("",!0),h(P,{onClick:i.onInit},{default:n(()=>[h(p,b({class:"poster"},i.pictureDataset,{title:e.title}),null,16,["title"]),r.loading?a(e.$slots,"loading-spinner",{key:0},void 0,!0):y("",!0),!r.ready&&!r.loading?a(e.$slots,"play",{key:1},void 0,!0):y("",!0)]),_:3},8,["onClick"]),a(e.$slots,"afterPlayer",{},void 0,!0)],2)}const q=g(T,[["render",G],["__scopeId","data-v-b7e5562e"]]),O={components:{BaseYoutube:q},props:v};function U(e,t,s,u,r,i){const p=c("base-youtube");return f(),E(p,b({class:"nuxt-booster-youtube"},e.$props),{beforePlayer:n(()=>[a(e.$slots,"beforePlayer",{},void 0,!0)]),"loading-spinner":n(()=>[a(e.$slots,"loading-spinner",{},()=>[t[0]||(t[0]=o("svg",{class:"loader loading-spinner",viewBox:"0 0 64 64",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[o("circle",{cx:"32",cy:"32",r:"29",fill:"transparent",stroke:"#ddd","stroke-width":"2"},[o("animateTransform",{attributeName:"transform",type:"rotate",from:"0 32 32",to:"360 32 32",begin:"0s",dur:"1.555s",repeatCount:"indefinite"})])],-1))],!0)]),play:n(()=>[a(e.$slots,"play",{},()=>[t[1]||(t[1]=o("svg",{class:"play",version:"1.1",viewBox:"0 0 68 48"},[o("path",{d:"M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z",fill:"#f00"}),o("path",{d:"M 45,24 27,14 27,34",fill:"#fff"})],-1))],!0)]),afterPlayer:n(()=>[a(e.$slots,"afterPlayer",{},void 0,!0)]),_:3},16)}const X=g(O,[["render",U],["__scopeId","data-v-91ee9453"]]);export{X as D};
