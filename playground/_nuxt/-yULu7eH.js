var et=Object.defineProperty;var st=(n,s,e)=>s in n?et(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e;var P=(n,s,e)=>st(n,typeof s!="symbol"?s+"":s,e);import{S as C,n as rt,u as R,c as it,B as nt,H as ot}from"./BYsZQHEi.js";import{t as at,b as ct}from"./CP0yG-nE.js";import{g as lt}from"./uryrx6lq.js";import{e as N,K as E,r as A,G as k,u as Q,c as F,o as _,h as V,a7 as ut,b as mt,F as ft,j as dt,i as D,z as O,_ as ht,a5 as pt,J as gt,I as w}from"./isEnetf2.js";import{u as G}from"./BC2C6LeS.js";const J=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,vt=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,U=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,yt=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,v=M(J,U,vt),S=M(U,J,yt),Y=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,_t=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,K=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,xt=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,y=M(Y,K,_t),B=M(K,Y,xt),p=/<(?!=)/,g=/>(?!=)/,T=/print/i,W=/^print$/i,h=Number.MAX_VALUE;function $(n){let s=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(n);if(s===null&&(v(n)||y(n))&&(s=/(\d)/.exec(n)),s==="0")return 0;if(s===null)return h;let e=s[1];switch(s[2]){case"ch":e=parseFloat(e)*8.8984375;break;case"em":case"rem":e=parseFloat(e)*16;break;case"ex":e=parseFloat(e)*8.296875;break;case"px":e=parseFloat(e);break}return+e}function M(n,s,e){return function(i){let t;return n.test(i)?t=!0:s.test(i)?t=!1:t=e.test(i),i.includes("not")?!t:t}}function j(n,s){const e=T.test(n),i=W.test(n),t=T.test(s),r=W.test(s);return e&&t?!i&&r?1:i&&!r?-1:n.localeCompare(s):e?1:t?-1:null}function wt(n){const e={}.unitlessMqAlwaysFirst;function i(t,r){const m=j(t,r);if(m!==null)return m;const d=v(t)||y(t),a=S(t)||B(t),c=v(r)||y(r),u=S(r)||B(r);if(e&&(!d&&!a||!c&&!u))return!d&&!a&&!c&&!u?t.localeCompare(r):!c&&!u?1:-1;{if(d&&u)return-1;if(a&&c)return 1;const o=$(t),f=$(r);if(o===h&&f===h)return t.localeCompare(r);if(o===h)return 1;if(f===h)return-1;if(o>f)return a?-1:1;if(o<f)return a?1:-1;if(o===f){if(a&&u){if(p.test(t)&&!p.test(r))return 1;if(!p.test(t)&&p.test(r))return-1}if(d&&c){if(g.test(t)&&!g.test(r))return 1;if(!g.test(t)&&g.test(r))return-1}}return t.localeCompare(r)}}return i.desktopFirst=function(t,r){const m=j(t,r);if(m!==null)return m;const d=v(t)||y(t),a=S(t)||B(t),c=v(r)||y(r),u=S(r)||B(r);if(e&&(!d&&!a||!c&&!u))return!d&&!a&&!c&&!u?t.localeCompare(r):!c&&!u?1:-1;{if(d&&u)return 1;if(a&&c)return-1;const o=$(t),f=$(r);if(o===h&&f===h)return t.localeCompare(r);if(o===h)return 1;if(f===h)return-1;if(o>f)return a?-1:1;if(o<f)return a?1:-1;if(o===f){if(a&&u){if(p.test(t)&&!p.test(r))return 1;if(!p.test(t)&&p.test(r))return-1}if(d&&c){if(g.test(t)&&!g.test(r))return 1;if(!g.test(t)&&g.test(r))return-1}}return-t.localeCompare(r)}},i}const St=wt();class z{constructor(s,e={}){P(this,"list",[]);P(this,"sort",!1);e=e||{},this.sort=e.sort||!1,this.list=this.list.concat(Array.from(s||this.list).map(i=>new C(i)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(s=>s.key).join("-")}get sorted(){return this.sort?this.list.sort((s,e)=>St(s.media||"",e.media||"")):this.list}get style(){return this.list.map(({media:s,width:e,height:i,style:t})=>`
      @media ${s} { .${this.className}::before { padding-top: calc((1 / (${e} / ${i})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${s} { .${this.className} { aspect-ratio: ${e} / ${i}; } }
      }
      ${t}
    `).reverse().join(" ")}get className(){return`picture-${at(this.sorted.map(({src:s})=>rt(s)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(s=>s.className)}}getFormats(s,e,i){return this.sorted.reduce((t,r)=>t.concat(s.map(m=>r.modify({format:m,preload:m.includes(e)&&i}))),[])}async getMeta(s,e){const i=await Promise.all(this.sorted.map(t=>{const r=s.getSizes(t.src,{sizes:t.sizes,modifiers:t.getModifiers(),...t.getOptions(e)});return r.src?t.getMeta(r.src,e):(console.warn("No src found for source",t),t)}).filter(Boolean));return new z(i)}toJSON(){return this.list}static create(...s){return new this(...s)}}var Bt={};const $t=["srcset","sizes","media","type"],At=N({__name:"Source",props:{source:{type:C,required:!0},crossorigin:{type:[Boolean,String],default(){return null},validator:n=>["anonymous","use-credentials","",!0,!1,void 0].includes(n)}},setup(n){const s=new Map([["jpg","jpeg"]]),e=n,i=R(),t=E().$booster,r=i.getSizes(e.source.src,{sizes:e.source.sizes,modifiers:e.source.getModifiers(),...e.source.getOptions(t)}),m=A(r.srcset||r.src),d=A(e.source.format&&`image/${s.get(e.source.format)||e.source.format}`),a=k(()=>lt(e.crossorigin||t.crossorigin)),c=new C(e.source);return Q(()=>({link:r&&c.preload&&m.value&&Bt.prerender?[c.getPreload(m.value,r.sizes,a.value)]:[]})),(u,o)=>(_(),F("source",{srcset:m.value,sizes:V(r).sizes,media:n.source.media,type:d.value},null,8,$t))}}),X={sources:{type:Array,default(){return[]}},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:it},sortSources:{type:Boolean,default:!0}},Mt=N({__name:"Base",props:X,emits:["load"],async setup(n,{emit:s}){let e,i;const t=["avif","webp","png","jpg","gif"],r=n,m=s,{isCritical:d}=G(),a=R(),c=E().$booster,u=z.create(r.sources,{sort:r.sortSources}),o=A(),f=r.formats||c.targetFormats,Z=Array.from(new Set(t.map(l=>f.find(x=>x.includes(l))))).filter(Boolean),q=t.find(l=>f.find(x=>x.includes(l))),b=A(u.getFormats(Z,q,d.value)),H=k(()=>{var l;return((l=o.value)==null?void 0:l.classNames)||{picture:"",image:[]}}),tt=l=>{m("load",l)};Q(()=>{if(o.value&&o.value.length){const l=o.value.classNames;return{style:[ct(o.value,l)]}}return{}});try{o.value=([e,i]=ut(()=>u.getMeta(a,c)),e=await e,i(),e)}catch(l){console.error(l)}return(l,x)=>(_(),F("picture",{class:O([H.value.picture,"nuxt-booster-picture"])},[(_(!0),F(ft,null,dt(b.value,I=>(_(),D(At,{key:I.key,source:I,crossorigin:l.crossorigin},null,8,["source","crossorigin"]))),128)),mt(nt,{class:O(H.value.image),title:l.title,alt:l.alt,crossorigin:l.crossorigin,width:"0",height:"0",onLoad:tt},null,8,["class","title","alt","crossorigin"])],2))}}),L=ht(Mt,[["__scopeId","data-v-50e8402b"]]),Ht=N({__name:"BoosterPicture",props:{hydrate:{type:Boolean,default:!0},...X},setup(n){const s=n,e=pt(),{isCritical:i}=G(),t=k(()=>s.hydrate?w(L,{...e,...s,hydrate:void 0,critical:i.value}):w(ot,{},[w("noscript",{class:"nuxt-booster-picture-noscript"},[w(L,{...e,...s,hydrate:void 0,critical:s.hydrate})])]));return(r,m)=>(_(),D(gt(V(t))))}});export{Ht as _};
