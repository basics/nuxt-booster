import{S as P,n as tt,u as j,c as et,B as st,H as rt}from"./FMfBPwam.js";import{t as it,b as nt}from"./CkJfcuOb.js";import{g as ot}from"#entry";import{e as F,G as R,j as A,B as N,u as E,c as C,o as _,h as Q,a7 as at,b as ct,F as lt,r as ut,k as V,s as I,_ as mt,a5 as ft,X as dt,L as w}from"./LxM7NZv2.js";import{a as D}from"./BDuYyG4j.js";const G=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,ht=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,U=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,pt=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,v=M(G,U,ht),B=M(U,G,pt),X=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,gt=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,Y=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,vt=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,y=M(X,Y,gt),S=M(Y,X,vt),p=/<(?!=)/,g=/>(?!=)/,L=/print/i,O=/^print$/i,h=Number.MAX_VALUE;function $(n){let r=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(n);if(r===null&&(v(n)||y(n))&&(r=/(\d)/.exec(n)),r==="0")return 0;if(r===null)return h;let e=r[1];switch(r[2]){case"ch":e=parseFloat(e)*8.8984375;break;case"em":case"rem":e=parseFloat(e)*16;break;case"ex":e=parseFloat(e)*8.296875;break;case"px":e=parseFloat(e);break}return+e}function M(n,r,e){return function(i){let t;return n.test(i)?t=!0:r.test(i)?t=!1:t=e.test(i),i.includes("not")?!t:t}}function T(n,r){const e=L.test(n),i=O.test(n),t=L.test(r),s=O.test(r);return e&&t?!i&&s?1:i&&!s?-1:n.localeCompare(r):e?1:t?-1:null}function yt(n){const e={}.unitlessMqAlwaysFirst;function i(t,s){const u=T(t,s);if(u!==null)return u;const d=v(t)||y(t),a=B(t)||S(t),c=v(s)||y(s),l=B(s)||S(s);if(e&&(!d&&!a||!c&&!l))return!d&&!a&&!c&&!l?t.localeCompare(s):!c&&!l?1:-1;{if(d&&l)return-1;if(a&&c)return 1;const o=$(t),m=$(s);if(o===h&&m===h)return t.localeCompare(s);if(o===h)return 1;if(m===h)return-1;if(o>m)return a?-1:1;if(o<m)return a?1:-1;if(o===m){if(a&&l){if(p.test(t)&&!p.test(s))return 1;if(!p.test(t)&&p.test(s))return-1}if(d&&c){if(g.test(t)&&!g.test(s))return 1;if(!g.test(t)&&g.test(s))return-1}}return t.localeCompare(s)}}return i.desktopFirst=function(t,s){const u=T(t,s);if(u!==null)return u;const d=v(t)||y(t),a=B(t)||S(t),c=v(s)||y(s),l=B(s)||S(s);if(e&&(!d&&!a||!c&&!l))return!d&&!a&&!c&&!l?t.localeCompare(s):!c&&!l?1:-1;{if(d&&l)return 1;if(a&&c)return-1;const o=$(t),m=$(s);if(o===h&&m===h)return t.localeCompare(s);if(o===h)return 1;if(m===h)return-1;if(o>m)return a?-1:1;if(o<m)return a?1:-1;if(o===m){if(a&&l){if(p.test(t)&&!p.test(s))return 1;if(!p.test(t)&&p.test(s))return-1}if(d&&c){if(g.test(t)&&!g.test(s))return 1;if(!g.test(t)&&g.test(s))return-1}}return-t.localeCompare(s)}},i}const _t=yt();class k{list=[];sort=!1;constructor(r,e={}){e=e||{},this.sort=e.sort||!1,this.list=this.list.concat(Array.from(r||this.list).map(i=>new P(i)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(r=>r.key).join("-")}get sorted(){return this.sort?this.list.sort((r,e)=>_t(r.media||"",e.media||"")):this.list}get style(){return this.list.map(({media:r,width:e,height:i,style:t})=>`
      @media ${r} { .${this.className}::before { padding-top: calc((1 / (${e} / ${i})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${r} { .${this.className} { aspect-ratio: ${e} / ${i}; } }
      }
      ${t}
    `).reverse().join(" ")}get className(){return`picture-${it(this.sorted.map(({src:r})=>tt(r)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(r=>r.className)}}getFormats(r,e,i){return this.sorted.reduce((t,s)=>t.concat(r.map(u=>s.modify({format:u,preload:u.includes(e)&&i}))),[])}async getMeta(r,e){const i=await Promise.all(this.sorted.map(t=>{const s=r.getSizes(t.src,{sizes:t.sizes,modifiers:t.getModifiers(),...t.getOptions(e)});return s.src?t.getMeta(s.src,e):(console.warn("No src found for source",t),t)}).filter(Boolean));return new k(i)}toJSON(){return this.list}static create(...r){return new this(...r)}}var xt={};const wt=["srcset","sizes","media","type"],Bt=F({__name:"Source",props:{source:{type:P,required:!0},crossorigin:{type:[Boolean,String],default(){return null},validator:n=>["anonymous","use-credentials","",!0,!1,void 0].includes(n)}},setup(n){const r=new Map([["jpg","jpeg"]]),e=n,i=j(),t=R().$booster,s=i.getSizes(e.source.src,{sizes:e.source.sizes,modifiers:e.source.getModifiers(),...e.source.getOptions(t)}),u=A(s.srcset||s.src),d=A(e.source.format&&`image/${r.get(e.source.format)||e.source.format}`),a=N(()=>ot(e.crossorigin||t.crossorigin)),c=new P(e.source);return E(()=>({link:s&&c.preload&&u.value&&xt.prerender?[c.getPreload(u.value,s.sizes,a.value)]:[]})),(l,o)=>(_(),C("source",{srcset:u.value,sizes:Q(s).sizes,media:n.source.media,type:d.value},null,8,wt))}}),J={sources:{type:Array,default(){return[]}},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:et},sortSources:{type:Boolean,default:!0}},St=F({__name:"Base",props:J,emits:["load"],async setup(n,{emit:r}){let e,i;const t=["avif","webp","png","jpg","gif"],s=n,u=r,{isCritical:d}=D(),a=j(),c=R().$booster,l=k.create(s.sources,{sort:s.sortSources}),o=A(),m=s.formats||c.targetFormats,K=Array.from(new Set(t.map(f=>m.find(x=>x.includes(f))))).filter(Boolean),Z=t.find(f=>m.find(x=>x.includes(f))),q=A(l.getFormats(K,Z,d.value)),z=N(()=>o.value?.classNames||{picture:"",image:[]}),b=f=>{u("load",f)};E(()=>{if(o.value&&o.value.length){const f=o.value.classNames;return{style:[nt(o.value,f)]}}return{}});try{o.value=([e,i]=at(()=>l.getMeta(a,c)),e=await e,i(),e)}catch(f){console.error(f)}return(f,x)=>(_(),C("picture",{class:I([z.value.picture,"nuxt-booster-picture"])},[(_(!0),C(lt,null,ut(q.value,H=>(_(),V(Bt,{key:H.key,source:H,crossorigin:f.crossorigin},null,8,["source","crossorigin"]))),128)),ct(st,{class:I(z.value.image),title:f.title,alt:f.alt,crossorigin:f.crossorigin,width:"0",height:"0",onLoad:b},null,8,["class","title","alt","crossorigin"])],2))}}),W=mt(St,[["__scopeId","data-v-6db6387c"]]),Ft=F({__name:"BoosterPicture",props:{hydrate:{type:Boolean,default:!0},...J},setup(n){const r=n,e=ft(),{isCritical:i}=D(),t=N(()=>r.hydrate?w(W,{...e,...r,hydrate:void 0,critical:i.value}):w(rt,{},[w("noscript",{class:"nuxt-booster-picture-noscript"},[w(W,{...e,...r,hydrate:void 0,critical:r.hydrate})])]));return(s,u)=>(_(),V(dt(Q(t))))}});export{Ft as _};
