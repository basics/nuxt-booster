var q=Object.defineProperty;var K=(i,e,t)=>e in i?q(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var M=(i,e,t)=>K(i,typeof e!="symbol"?e+"":e,t);import{u as W}from"./BCYAbyMa.js";import{S as C,n as Z,u as j,c as b,B as tt,L as et}from"./D8bb-IZd.js";import{u as T}from"./BIeE6KL-.js";import{J as E,r as y,o as v,c as F,u as P,_ as st,C as rt,ak as it,F as nt,q as ot,l as R,b as at,i as z,E as ct,G as _}from"./Blc8pwaY.js";import{t as lt,c as ut}from"./BRWpFFLA.js";import{g as mt}from"./DtMZnCtO.js";const Q=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,dt=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,V=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,ht=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,g=A(Q,V,dt),w=A(V,Q,ht),G=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,ft=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,J=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,gt=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,p=A(G,J,ft),S=A(J,G,gt),H=/print/i,I=/^print$/i,f=Number.MAX_VALUE;function B(i){let e=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(i);if(e===null&&(g(i)||p(i))&&(e=/(\d)/.exec(i)),e==="0")return 0;if(e===null)return f;let t=e[1];switch(e[2]){case"ch":t=parseFloat(t)*8.8984375;break;case"em":case"rem":t=parseFloat(t)*16;break;case"ex":t=parseFloat(t)*8.296875;break;case"px":t=parseFloat(t);break}return+t}function A(i,e,t){return function(n){return i.test(n)?!0:e.test(n)?!1:t.test(n)}}function L(i,e){const t=H.test(i),n=I.test(i),s=H.test(e),r=I.test(e);return t&&s?!n&&r?1:n&&!r?-1:i.localeCompare(e):t?1:s?-1:null}function pt(i){const t={}.unitlessMqAlwaysFirst;function n(s,r){const l=L(s,r);if(l!==null)return l;const h=g(s)||p(s),a=w(s)||S(s),c=g(r)||p(r),u=w(r)||S(r);if(t&&(!h&&!a||!c&&!u))return!h&&!a&&!c&&!u?s.localeCompare(r):!c&&!u?1:-1;{if(h&&u)return-1;if(a&&c)return 1;const o=B(s),d=B(r);return o===f&&d===f?s.localeCompare(r):o===f?1:d===f?-1:o>d?a?-1:1:o<d?a?1:-1:s.localeCompare(r)}}return n.desktopFirst=function(s,r){const l=L(s,r);if(l!==null)return l;const h=g(s)||p(s),a=w(s)||S(s),c=g(r)||p(r),u=w(r)||S(r);if(t&&(!h&&!a||!c&&!u))return!h&&!a&&!c&&!u?s.localeCompare(r):!c&&!u?1:-1;{if(h&&u)return 1;if(a&&c)return-1;const o=B(s),d=B(r);return o===f&&d===f?s.localeCompare(r):o===f?1:d===f?-1:o>d?a?-1:1:o<d?a?1:-1:-s.localeCompare(r)}},n}const yt=pt();class ${constructor(e,t={}){M(this,"list",[]);M(this,"sort",!1);t=t||{},this.sort=t.sort||!1,this.list=this.list.concat(Array.from(e||this.list).map(n=>new C(n)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(e=>e.key).join("-")}get sorted(){return this.sort?this.list.sort((e,t)=>yt(e.media,t.media)):this.list}get style(){return this.list.map(({media:e,width:t,height:n,style:s})=>`
      @media ${e} { .${this.className}::before { padding-top: calc((1 / (${t} / ${n})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${e} { .${this.className} { aspect-ratio: ${t} / ${n}; } }
      }
      ${s}
    `).reverse().join(" ")}get className(){return`picture-${lt(this.sorted.map(({src:e})=>Z(e)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(e=>e.className)}}getFormats(e,t,n){return this.sorted.reduce((s,r)=>s.concat(e.map(l=>r.modify({format:l,preload:l.includes(t)&&n}))),[])}async getMeta(e,t){const n=await Promise.all(this.sorted.map(s=>{const r=e.getSizes(s.src,{sizes:s.sizes,modifiers:s.getModifiers(),...s.getOptions(t)});return s.getMeta(r.src,t)}));return new $(n)}toJSON(){return this.list}static create(...e){return new this(...e)}}var vt={};const xt=["srcset","sizes","media","type"],_t={__name:"Source",props:{source:{type:C,required:!0},crossorigin:{type:[Boolean,String],default(){return null},validator:i=>["anonymous","use-credentials","",!0,!1].includes(i)}},setup(i){const e=new Map([["jpg","jpeg"]]),t=i,n=j(),s=E().$booster,r=n.getSizes(t.source.src,{sizes:t.source.sizes,modifiers:t.source.getModifiers(),...t.source.getOptions(s)}),l=y(r.srcset||r.src),h=y(`image/${e.get(t.source.format)||t.source.format}`),a=y(mt(t.crossorigin||s.crossorigin)),c=new C(t.source);return T({link:[r&&c.preload&&vt.prerender&&c.getPreload(l,r.sizes,a)].filter(Boolean)}),(u,o)=>(v(),F("source",{srcset:l.value,sizes:P(r).sizes,media:i.source.media,type:h.value},null,8,xt))}},wt={__name:"Base",props:{sources:{type:[Array,$],required:!0},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:b},sortSources:{type:Boolean,default:!0}},emits:["load"],async setup(i,{emit:e}){let t,n;const s=["avif","webp","png","jpg","gif"],r=i,l=e,{isCritical:h}=W(),a=j(),c=E().$booster,u=$.create(r.sources,{sort:r.sortSources}),o=y(null),d=r.formats||c.targetFormats,U=Array.from(new Set(s.map(m=>d.find(x=>x.includes(m))))).filter(Boolean),Y=s.find(m=>d.find(x=>x.includes(m))),D=y(u.getFormats(U,Y,h)),N=rt(()=>{var m;return((m=o.value)==null?void 0:m.classNames)||{}}),X=m=>{l("load",m)};T(()=>{if(o.value&&o.value.length){const m=o.value.classNames;return{style:[ut(o.value,m)]}}return{}});try{o.value=([t,n]=it(()=>u.getMeta(a,c)),t=await t,n(),t)}catch(m){console.error(m)}return(m,x)=>(v(),F("picture",{class:z([N.value.picture,"nuxt-booster-picture"])},[(v(!0),F(nt,null,ot(D.value,k=>(v(),R(P(_t),{key:k.key,source:k,crossorigin:i.crossorigin},null,8,["source","crossorigin"]))),128)),at(P(tt),{class:z(N.value.image),title:i.title,alt:i.alt,crossorigin:i.crossorigin,width:"0",height:"0",onLoad:X},null,8,["class","title","alt","crossorigin"])],2))}},O=st(wt,[["__scopeId","data-v-2e48fa63"]]),Pt=Object.assign({inheritAttrs:!1},{__name:"BoosterPicture",props:{hydrate:{type:Boolean,default:!0}},setup(i){const e=i,t=ct(),{isCritical:n}=W(),s=()=>e.hydrate?_(O,{...t,critical:n.value}):_(et,{never:!0},[_("noscript",{class:"nuxt-booster-picture-noscript"},[_(O,{...t,critical:e.hydrate})])]);return(r,l)=>(v(),R(s))}});export{Pt as _};
