var Q=Object.defineProperty;var V=(i,e,t)=>e in i?Q(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var B=(i,e,t)=>V(i,typeof e!="symbol"?e+"":e,t);import{u as L}from"./DT2a43aF.js";import{u as H,B as G,c as J,L as U}from"./CN0mT2An.js";import{u as I}from"./4GkioB90.js";import{_ as O,J as W,C as Y,o as v,c as A,r as D,P as M,F as X,q,l as K,b as Z,i as C,G as p}from"./CZyDHtZv.js";import{S as $,t as b,n as tt,c as et}from"./rz2uSi-z.js";import{g as st}from"./CM_-ckP9.js";const j=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,rt=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,T=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,it=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,f=w(j,T,rt),y=w(T,j,it),R=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,nt=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,E=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,ot=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,g=w(R,E,nt),_=w(E,R,ot),F=/print/i,N=/^print$/i,h=Number.MAX_VALUE;function x(i){let e=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(i);if(e===null&&(f(i)||g(i))&&(e=/(\d)/.exec(i)),e==="0")return 0;if(e===null)return h;let t=e[1];switch(e[2]){case"ch":t=parseFloat(t)*8.8984375;break;case"em":case"rem":t=parseFloat(t)*16;break;case"ex":t=parseFloat(t)*8.296875;break;case"px":t=parseFloat(t);break}return+t}function w(i,e,t){return function(n){return i.test(n)?!0:e.test(n)?!1:t.test(n)}}function P(i,e){const t=F.test(i),n=N.test(i),r=F.test(e),s=N.test(e);return t&&r?!n&&s?1:n&&!s?-1:i.localeCompare(e):t?1:r?-1:null}function ct(i){const t={}.unitlessMqAlwaysFirst;function n(r,s){const o=P(r,s);if(o!==null)return o;const a=f(r)||g(r),c=y(r)||_(r),u=f(s)||g(s),l=y(s)||_(s);if(t&&(!a&&!c||!u&&!l))return!a&&!c&&!u&&!l?r.localeCompare(s):!u&&!l?1:-1;{if(a&&l)return-1;if(c&&u)return 1;const m=x(r),d=x(s);return m===h&&d===h?r.localeCompare(s):m===h?1:d===h?-1:m>d?c?-1:1:m<d?c?1:-1:r.localeCompare(s)}}return n.desktopFirst=function(r,s){const o=P(r,s);if(o!==null)return o;const a=f(r)||g(r),c=y(r)||_(r),u=f(s)||g(s),l=y(s)||_(s);if(t&&(!a&&!c||!u&&!l))return!a&&!c&&!u&&!l?r.localeCompare(s):!u&&!l?1:-1;{if(a&&l)return 1;if(c&&u)return-1;const m=x(r),d=x(s);return m===h&&d===h?r.localeCompare(s):m===h?1:d===h?-1:m>d?c?-1:1:m<d?c?1:-1:-r.localeCompare(s)}},n}const at=ct();class S{constructor(e,t={}){B(this,"list",[]);B(this,"sort",!1);t=t||{},this.sort=t.sort||!1,this.list=this.list.concat(Array.from(e||this.list).map(n=>new $(n)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(e=>e.key).join("-")}get sorted(){return this.sort?this.list.sort((e,t)=>at(e.media,t.media)):this.list}get style(){return this.list.map(({media:e,width:t,height:n,style:r})=>`
      @media ${e} { .${this.className}::before { padding-top: calc((1 / (${t} / ${n})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${e} { .${this.className} { aspect-ratio: ${t} / ${n}; } }
      }
      ${r}
    `).reverse().join(" ")}get className(){return`picture-${b(this.sorted.map(({src:e})=>tt(e)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(e=>e.className)}}getFormats(e,t,n){return this.sorted.reduce((r,s)=>r.concat(e.map(o=>s.modify({format:o,preload:o.includes(t)&&n}))),[])}async getMeta(e,t){const n=await Promise.all(this.sorted.map(r=>{const s=e.getSizes(r.src,{sizes:r.sizes,modifiers:r.getModifiers(),...r.getOptions(t)});return r.getMeta(s.src,t)}));return new S(n)}toJSON(){return this.list}static create(...e){return new this(...e)}}var ut={};const lt=new Map([["jpg","jpeg"]]),mt={props:{source:{type:$,required:!0},crossorigin:{type:[Boolean,String],default(){return null},validator:i=>["anonymous","use-credentials","",!0,!1].includes(i)}},setup(i){const e=H(),t=W().$booster,n=e.getSizes(i.source.src,{sizes:i.source.sizes,modifiers:i.source.getModifiers(),...i.source.getOptions(t)}),r=Y(()=>st(i.crossorigin||t.crossorigin)),s=new $(i.source);return I({link:[n&&s.preload&&ut.prerender&&s.getPreload(n.srcset,n.sizes,r)].filter(Boolean)}),{config:n,resolvedCrossorigin:r}},computed:{srcset(){return this.config.srcset||this.config.src},type(){return`image/${lt.get(this.source.format)||this.source.format}`}}},dt=["srcset","sizes","media","type"];function ht(i,e,t,n,r,s){return v(),A("source",{srcset:s.srcset,sizes:n.config.sizes,media:t.source.media,type:s.type},null,8,dt)}const ft=O(mt,[["render",ht]]),k=["avif","webp","png","jpg","gif"],gt={components:{PictureSource:ft,BaseImage:G},props:{sources:{type:[Array,S],required:!0},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:J},sortSources:{type:Boolean,default:!0}},emits:["load"],async setup(i){const{isCritical:e}=L(),t=H(),n=W().$booster,r=S.create(i.sources,{sort:i.sortSources}),s=D(null);I(()=>{if(s.value&&s.value.length){const o=s.value.classNames;return{style:[et(s.value,o)]}}return{}});try{s.value=await r.getMeta(t,n)}catch(o){console.error(o)}return{isCritical:e,resolvedFormats:i.formats||n.targetFormats,sourceList:r,metaSources:s,classNames:s.value.classNames}},computed:{formatSources(){const i=Array.from(new Set(k.map(t=>this.resolvedFormats.find(n=>n.includes(t))))).filter(Boolean),e=k.find(t=>this.resolvedFormats.find(n=>n.includes(t)));return this.sourceList.getFormats(i,e,this.isCritical)}},methods:{onLoad(i){this.$emit("load",i)}}};function pt(i,e,t,n,r,s){const o=M("picture-source"),a=M("base-image");return v(),A("picture",{class:C([n.classNames.picture,"nuxt-booster-picture"])},[(v(!0),A(X,null,q(s.formatSources,c=>(v(),K(o,{key:c.key,source:c,crossorigin:t.crossorigin},null,8,["source","crossorigin"]))),128)),Z(a,{class:C(n.classNames.image),title:t.title,alt:t.alt,crossorigin:t.crossorigin,width:"0",height:"0",onLoad:s.onLoad},null,8,["class","title","alt","crossorigin","onLoad"])],2)}const z=O(gt,[["render",pt],["__scopeId","data-v-3842eeee"]]),At={inheritAttrs:!1,props:{hydrate:{type:Boolean,default:!0}},setup(){const{isCritical:i}=L();return{isCritical:i}},render(){return this.hydrate?p(z,{...this.$attrs,critical:this.isCritical}):p(U,{never:!0},[p("noscript",{class:"nuxt-booster-picture-noscript"},[p(z,{...this.$attrs,critical:this.hydrate})])])}};export{At as _};
