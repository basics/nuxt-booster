import{u as J,D as K}from"./3wMc-Hm4.js";import{D as W,a as X}from"./CGIMxDkA.js";import{_ as Z}from"./2nYaNr9U.js";import{e as M,j as r,B as m,q as ee,ad as ae,u as te,ae as se,a7 as A,D as V,c as C,o as D,Y as o,a as l,n as k,g as I,b as L,w as f,p as R,m as T,s as re,a6 as le,_ as U,k as oe}from"./DSshErR-.js";import{a as ne}from"./DruklU9u.js";const Y=new W;window.BOOSTER_VIMEO_API_RESOLVE=s=>{Y.resolve(s),delete window.BOOSTER_VIMEO_API_RESOLVE};var p=(s=>(s[s.PLAYING=0]="PLAYING",s[s.ENDED=1]="ENDED",s[s.PAUSE=2]="PAUSE",s))(p||{});function ue(){return{key:"vimeo",src:"https://player.vimeo.com/api/player.js",async:!0,defer:!0,onload:"VIMEO_API_RESOLVE(window.Vimeo)"}}function j(){return Y.promise}class ie{api;players=[];play(a){return this.pausePlayers(a),a.play()}pausePlayers(a){return Promise.all(this.players.filter(e=>!a||a&&e!==a).map(async e=>{await e.getPaused()||e.pause()}))}async createPlayer(a){this.api=await j();const e=new this.api.Player(a);return e.on("playing",()=>this.pausePlayers(e)),this.add(e),e}add(a){this.players.push(a)}remove(a){this.players=this.players.filter(e=>e!==a),a.destroy()}}const G={url:{type:String,required:!0},autoplay:{type:Boolean,default:!1},mute:{type:Boolean,default:void 0},title:{type:String,required:!1,default:null},options:{type:Object,default(){return{}}},posterSources:{type:Array,default(){return[{src:void 0,media:"all",sizes:{default:"100vw"}}]}}};var pe={};const ve={class:"player"},ce=["inert","title","src"],de=M({__name:"Base",props:G,emits:["ready","playing"],async setup(s,{emit:a}){let e,v;ne();const q=J(),w=new ie,_=r(!1),n=r(void 0),c=r(void 0),y=r(!1),g=r(!1),d=r(!1),z=r(X()),u=s,b=a,E=r([]),i=r(),P=r(!1),h=r(),F=r(new URL(u.url||"").pathname.replace("/","")),S=m(()=>u.title||i.value&&i.value.title),H=m(()=>({dnt:!0,autopause:!1,...u.options,playsinline:!0,autoplay:u.autoplay,muted:z.value||u.mute})),Q=m(()=>({formats:q.targetFormats,title:u.title,sources:u.posterSources.map(t=>({...t,src:t.src||i.value?.thumbnail_url?.replace("https://i.vimeocdn.com","vimeo")||""}))}));ee(()=>{_.value=!0}),ae(()=>{n.value&&w.remove(n.value)}),pe.prerender||te({script:m(()=>E.value)});const N=m(()=>i.value?.html.replace(/.*src="([^"]*)".*/,"$1").replace(/&amp;/g,"&")||`https://player.vimeo.com/video/${F.value}`);try{const t=se("https://vimeo.com/api/oembed.json",{url:u.url,width:1920,height:1080,...H.value}),B=([e,v]=A(()=>fetch(t)),e=await e,v(),e);i.value=([e,v]=A(()=>B.json()),e=await e,v(),e)}catch(t){console.error(t),P.value=!0,h.value=N.value}V(()=>i.value,t=>{t&&u.autoplay&&O()}),V(()=>y.value,()=>{_.value=!1});function O(){g.value=!0,h.value=N.value,E.value=[ue()],P.value&&c.value&&(c.value.src=String(c.value.src))}function $(t){t===p.PLAYING?d.value=!0:(t===p.ENDED||t===p.PAUSE)&&(d.value=!1),b("playing",d.value)}async function x(t){!t.target?.src||!E.value.length||(await j(),c.value&&(n.value=le(await w.createPlayer(c.value)),n.value.on("playing",()=>$(p.PLAYING)),n.value.on("pause",()=>$(p.PAUSE)),n.value.on("ended",()=>$(p.ENDED)),await n.value.ready(),w.play(n.value),g.value=!1,y.value=!0,b("ready",{iframe:n.value.element,player:n.value})))}return(t,B)=>(D(),C("div",{class:re({ready:y.value,playing:d.value,"iframe-mode":P.value})},[o(t.$slots,"background",k(I({playing:d.value,videoData:i.value})),void 0,!0),l("div",ve,[o(t.$slots,"beforePlayer",{},void 0,!0),(D(),C("iframe",{ref_key:"playerEl",ref:c,key:h.value,inert:_.value,title:S.value,src:h.value,allow:"autoplay; fullscreen; picture-in-picture",onLoad:x},null,40,ce)),L(K,{"aria-label":"Play Video",onClick:O},{default:f(()=>[L(Z,T({class:"poster"},Q.value,{title:S.value}),null,16,["title"]),g.value?o(t.$slots,"loading-spinner",{key:0},void 0,!0):R("",!0),!y.value&&!g.value?o(t.$slots,"play",{key:1},void 0,!0):R("",!0)]),_:3}),o(t.$slots,"afterPlayer",{},void 0,!0)]),o(t.$slots,"default",k(I({playing:d.value,videoData:i.value})),void 0,!0)],2))}}),fe=U(de,[["__scopeId","data-v-714c3032"]]),me=M({__name:"BoosterVimeo",props:G,setup(s){return(a,e)=>(D(),oe(fe,T({class:"nuxt-booster-vimeo"},a.$props),{beforePlayer:f(()=>[o(a.$slots,"beforePlayer",{},void 0,!0)]),"loading-spinner":f(()=>[o(a.$slots,"loading-spinner",{},()=>[e[0]||(e[0]=l("div",{class:"loading-spinner"},[l("svg",{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#fff"},[l("g",{fill:"none","fill-rule":"evenodd"},[l("g",{transform:"translate(1 1)","stroke-width":"2"},[l("circle",{"stroke-opacity":".5",cx:"18",cy:"18",r:"18"}),l("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[l("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})])])])])],-1))],!0)]),play:f(()=>[o(a.$slots,"play",{},()=>[e[1]||(e[1]=l("div",{class:"play"},[l("span",null,[l("svg",{viewBox:"0 0 20 20",preserveAspectRatio:"xMidYMid",focusable:"false"},[l("polygon",{class:"fill",points:"1,0 20,10 1,20"})])])],-1))],!0)]),default:f(v=>[o(a.$slots,"default",k(I(v)),void 0,!0)]),afterPlayer:f(()=>[o(a.$slots,"afterPlayer",{},void 0,!0)]),_:3},16))}}),Ee=U(me,[["__scopeId","data-v-0559314a"]]);export{Ee as B};
